    <header>
      {%- for language in snippets.languages %}
        {%- if page.language == site.default_language %}
          {%- assign url = site.baseurl | append: '/'%}
        {%- else %}
          {%- assign nav_pages = site.pages
            | where: 'language_reference', 'stories'
            | where: 'language', page.language %}
          {%- for nav_page in nav_pages %}
            {%- assign url = site.baseurl | append: nav_page.url %}
          {%- endfor %}
        {%- endif %}
      {%- endfor %}
      <h1 class="site-title">
        <a href="{{ url }}" {%- if page.url == '/' %} class="current"{%- endif %}>{{ site.title }}</a>
      </h1>

      <nav>
        <ul class="navigation-pages">
          {%- assign nav_pages = site.pages
            | where: 'language', page.language
            | where: 'layout', 'page', %}
          {%- for nav_page in nav_pages %}
          <li>
            <a href="{{ site.baseurl }}{{ nav_page.url }}" {%- if nav_page.title == page.title %} class="current"{%- endif %}>{{ nav_page.title }}</a>
          </li>
          {%- endfor %}
        </ul>

        <ul class="navigation-language-switch">
          {%- for language in snippets.languages %}

            {%- if page.layout == 'page' %}
              {%- assign nav_pages = site.pages
                | where: 'language_reference', page.language_reference
                | where: 'language', language[1].slug %}
              {%- if nav_pages.size > 0 %}
                {%- for nav_page in nav_pages %}
                  {%- assign url = site.baseurl | append: nav_page.url %}
                {%- endfor %}
              {%- else %}
                {%- assign nav_pages = site.pages
                  | where: 'language_reference', 'stories'
                  | where: 'language', language[1].slug %}
                {%- for nav_page in nav_pages %}
                  {%- assign url = site.baseurl | append: nav_page.url %}
                {%- endfor %}
              {%- endif %}

            {%- elsif page.layout == 'post' %}
              {%- assign nav_posts = site.posts
                | where: 'language_reference', page.language_reference
                | where: 'language', language[1].slug %}
              {%- if nav_posts.size > 0 %}
                {%- for nav_post in nav_posts %}
                  {%- assign url = site.baseurl | append: nav_post.url %}
                {%- endfor %}
              {%- else %}
                {%- assign nav_pages = site.pages
                  | where: 'language_reference', 'stories'
                  | where: 'language', language[1].slug %}
                {%- for nav_page in nav_pages %}
                  {%- assign url = site.baseurl | append: nav_page.url %}
                {%- endfor %}
              {%- endif %}

            {%- elsif page.layout == 'index' %}
              {%- assign nav_pages = site.pages
                | where: 'language_reference', 'stories'
                | where: 'language', language[1].slug %}
              {%- for nav_page in nav_pages %}
                {%- assign url = site.baseurl | append: nav_page.url %}
              {%- endfor %}
            {%- endif %}
            <li>
              <a href="{{ url }}" {%- if language[1].slug == page.language %} class="current"{%- endif %}>{{ language[1].value }}</a>
            </li>
          {%- endfor %}
        </ul>
      </nav>
    </header>